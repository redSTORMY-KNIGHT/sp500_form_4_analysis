ACCESSION_NUMBER	ISSUERCIK	ISSUERNAME	ISSUERTRADINGSYMBOL	GICS_SECTOR	GICS_SUB_INDUSTRY	OWNER_CIK	OWNER_NAME	OWNER_RELATIONSHIP	SECURITY_TITLE	TRANS_YEAR	TRANS_DATE	SHARES_OWNED_BEFORE_TRANSACTION	Per_of_Total_Shares	TRANS_SHARES	Total_Purchase_Cost	TRANS_PRICEPERSHARE	Return_Date	Stock_Price_12_Months	Stock_Return_12_Months	SP500_Day_of_Purchase	SP500_12_Months_After_Purchase	SP500_Return_12_Months	Relative_to_SP_500	Sector_Day_of_Purchase	Sector_12_Months_After_Purchase	Sector_Return_12_Months	Relative_to_Sector
0000899243-22-009579	797468	OCCIDENTAL PETROLEUM CORP /DE/	OXY	Energy	Oil & Gas Exploration & Production	1067983	BERKSHIRE HATHAWAY INC	TenPercentOwner	Common Stock	2022	4-Mar-2022	80214263	12.60%	10110321	$563,953,705.38 	$55.78 	4-Mar-2023	$61.68 	11%	4328.87	4045.64	-7%	18%	569.81	664.3	17%	-6%
0000899243-22-009579	797468	OCCIDENTAL PETROLEUM CORP /DE/	OXY	Energy	Oil & Gas Exploration & Production	315090	BUFFETT WARREN E	TenPercentOwner	Common Stock	2022	4-Mar-2022	80214263	12.60%	10110321	$563,953,705.38 	$55.78 	4-Mar-2023	$61.68 	11%	4328.87	4045.64	-7%	18%	569.81	664.3	17%	-6%
0000899243-22-010798	797468	OCCIDENTAL PETROLEUM CORP /DE/	OXY	Energy	Oil & Gas Exploration & Production	1067983	BERKSHIRE HATHAWAY INC	TenPercentOwner	Common Stock	2022	9-Mar-2022	105199820	9.27%	9753917	$559,679,757.46 	$57.38 	9-Mar-2023	$60.56 	6%	4277.88	3918.32	-8%	14%	568.1	637.81	12%	-6%
ACCESSION_NUMBER	FILING_DATE	PERIOD_OF_REPORT	ISSUERCIK	ISSUERNAME	ISSUERTRADINGSYMBOL	GICS_SECTOR	GICS_SUB_INDUSTRY	OWNER_CIK	OWNER_NAME	OWNER_RELATIONSHIP	SECURITY_TITLE	TRANS_DATE	TRANS_SHARES	TRANS_PRICEPERSHARE	DIRECT_INDIRECT_OWNERSHIP	SHARES_OWNED_FOLLOWING_TRANSACTION	6 Month Price	1 Year Price	18 Month Price	Market Cap


Date	S&P 500	Communication Services	Consumer Discretionary	Consumer Staples	Energy	Financials	Health Care	Industrials	Information Technology	Materials	Real Estate	Utilities


ACCESSION_NUMBER	FILING_DATE	PERIOD_OF_REPORT	ISSUERCIK	ISSUERNAME	ISSUERTRADINGSYMBOL	GICS_SECTOR	GICS_SUB_INDUSTRY	OWNER_CIK	OWNER_NAME	OWNER_RELATIONSHIP	SECURITY_TITLE	TRANS_DATE	TRANS_SHARES	TRANS_PRICEPERSHARE	DIRECT_INDIRECT_OWNERSHIP	SHARES_OWNED_FOLLOWING_TRANSACTION	6 Month Price	1 Year Price	18 Month Price	Market Cap	SP500	SECTOR	SP500_6M	SECTOR_6M	SP500_1Y	SECTOR_1Y	SP500_18M	SECTOR_18M	SP500_RETURN_6M	SECTOR_RETURN_6M	SP500_RETURN_1Y	SECTOR_RETURN_1Y	SP500_RETURN_18M	SECTOR_RETURN_18M


Symbol	Date	Split Ratio


ACCESSION_NUMBER	FILING_DATE	PERIOD_OF_REPORT	ISSUERCIK	ISSUERNAME	ISSUERTRADINGSYMBOL	GICS_SECTOR	GICS_SUB_INDUSTRY	OWNER_CIK	OWNER_NAME	OWNER_RELATIONSHIP	SECURITY_TITLE	TRANS_DATE	TRANS_SHARES	TRANS_PRICEPERSHARE	DIRECT_INDIRECT_OWNERSHIP	SHARES_OWNED_FOLLOWING_TRANSACTION	SPLIT_ADJUSTMENT	ADJUSTED_TRANS_SHARES	ADJUSTED_TRANS_PRICEPERSHARE	ADJUSTED_SHARES_OWNED_FOLLOWING	6 Month Price	1 Year Price	18 Month Price	Market Cap	SP500	SECTOR	SP500_6M	SECTOR_6M	SP500_1Y	SECTOR_1Y	SP500_18M	SECTOR_18M	SP500_RETURN_6M	SECTOR_RETURN_6M	SP500_RETURN_1Y	SECTOR_RETURN_1Y	SP500_RETURN_18M	SECTOR_RETURN_18M



ACCESSION_NUMBER	FILING_DATE	PERIOD_OF_REPORT	ISSUERCIK	ISSUERNAME	ISSUERTRADINGSYMBOL	GICS_SECTOR	GICS_SUB_INDUSTRY	OWNER_CIK	OWNER_NAME	OWNER_RELATIONSHIP	SECURITY_TITLE	TRANS_DATE	TRANS_SHARES	TRANS_PRICEPERSHARE	DIRECT_INDIRECT_OWNERSHIP	SHARES_OWNED_FOLLOWING_TRANSACTION	SPLIT_ADJUSTMENT	ADJUSTED_TRANS_SHARES	ADJUSTED_TRANS_PRICEPERSHARE	ADJUSTED_SHARES_OWNED_FOLLOWING	6 Month Price	1 Year Price	18 Month Price	RETURN_6M	RETURN_1Y	RETURN_18M	Market Cap	SP500	SECTOR	SP500_6M	SECTOR_6M	SP500_1Y	SECTOR_1Y	SP500_18M	SECTOR_18M	SP500_RETURN_6M	SECTOR_RETURN_6M	SP500_RETURN_1Y	SECTOR_RETURN_1Y	SP500_RETURN_18M	SECTOR_RETURN_18M


I have a csv file that contains Form 4 insider transactions from the last 10 years. I want to calculate the weighted returns for each individual investor benchmarked against the weighted returns for SP500 and the relevant sector. Here is the file path for the CSV as well as the relevant column headers.

insider transactions csv path: "C:\Users\Riot\OneDrive\Business\SP500_form4_analysis\transactions_with_returns.csv"

insider transactions csv column headers: ACCESSION_NUMBER	FILING_DATE	PERIOD_OF_REPORT	ISSUERCIK	ISSUERNAME	ISSUERTRADINGSYMBOL	GICS_SECTOR	GICS_SUB_INDUSTRY	OWNER_CIK	OWNER_NAME	OWNER_RELATIONSHIP	SECURITY_TITLE	TRANS_DATE	TRANS_SHARES	TRANS_PRICEPERSHARE	DIRECT_INDIRECT_OWNERSHIP	SHARES_OWNED_FOLLOWING_TRANSACTION	SPLIT_ADJUSTMENT	ADJUSTED_TRANS_SHARES	ADJUSTED_TRANS_PRICEPERSHARE	ADJUSTED_SHARES_OWNED_FOLLOWING	6 Month Price	1 Year Price	18 Month Price	RETURN_6M	RETURN_1Y	RETURN_18M	Market Cap	SP500	SECTOR	SP500_6M	SECTOR_6M	SP500_1Y	SECTOR_1Y	SP500_18M	SECTOR_18M	SP500_RETURN_6M	SECTOR_RETURN_6M	SP500_RETURN_1Y	SECTOR_RETURN_1Y	SP500_RETURN_18M	SECTOR_RETURN_18M



The calculation for weighted returns are as follows: 

=SUMPRODUCT(ADJUSTED_TRANS_PRICEPERSHARE*RETURN_6M)/SUM(ADJUSTED_TRANS_PRICEPERSHARE)